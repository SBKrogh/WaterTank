% \begin{figure}[H]
% \centering
% \begin{tikzpicture}
% %\draw (-1.5,-1.5) rectangle (13.5,1.5);

% \draw (-2.8,3.1) rectangle (2.8,-12.8);
% \node at (0,2.5) {\textbf{RIO}};


% \draw (-2.5,2) rectangle (2.5,-4.2);
% \node at (0,1.5) {\textbf{Micro processor}};
% \node[box] (datlog) at (0,0.3) {Data logging};
% \node[box] (ethcommu) at ($(0,-1.7) + (datlog)$) {Ethernet communication};
% \node[box] (shuterr) at ($(0,-1.7) + (ethcommu)$) {Shutdown:\\Communication error};


% \draw (-2.5,-4.7) rectangle (2.5,-12.6);
% \node at (0,-5.2) {\textbf{FPGA}};
% \node[box] (poscon) at ($(0,-3.3) + (shuterr)$) {Position control};
% \node[box] (enco) at ($(0,-1.7) + (poscon)$) {Encoder counter};
% \node[box] (PWM) at ($(0,-1.7) + (enco)$) {PWM control};
% \node[box] (dataES) at ($(0,-1.7) + (PWM)$) {Read data: ESCON};


% \draw (-9,-6) rectangle (-4,-12.6);
% \node[box] (spcon) at (-6.5,-8) {Speed control\\with inner current\\control};
% \node at ($(spcon) + (0,1.5)$) {\textbf{ESCON}};
% \node at ($(spcon) + (0,1.2)$) {\textbf{motor controller}};
% \node[box] (limcu) at ($(0,-1.7) + (spcon)$) {Limit output\\current};
% \node[box] (reen) at ($(0,-1.7) + (limcu)$) {Read encoder\\ticks};


% \draw (-9,-5.5) rectangle (-4,-4);
% \node at (-6.5,-4.75) {\textbf{Motor}};


% \draw (-9,-3.5) rectangle (-4,3.1);
% \node at (-6.5,2.5) {\textbf{ROS computer}};

%\node[fill = {rgb:red,1;green,2;blue,5},box] (Opt) at (0,0) {Operator};
%\node[fill = {rgb:red,1;green,2;blue,5},box] (Geo) at ($(3,0) + (Opt)$) {};
%\node[fill = {rgb:red,1;green,2;blue,5},box] (ros) at ($(3,0) + (Geo)$) {Robotic\\operating\\system};
%\node[fill = {rgb:red,1;green,2;blue,5},box] (davin) at ($(3,0) + (ros)$) {Da Vinci\\robot};
%\node[fill = {rgb:red,1;green,2;blue,5},box] (end) at ($(3,0) + (davin)$) {Endowrist};


%\draw[->, ultra thick] ([yshift=0.3cm]Opt.east) -- ([yshift=0.3cm]Geo.west);
%\draw[->, ultra thick] ([yshift=0.3cm]Geo.east) -- ([yshift=0.3cm]ros.west);
%\draw[->, ultra thick] ([yshift=0.3cm]ros.east) -- ([yshift=0.3cm]davin.west);
%\draw[->, ultra thick] ([yshift=0.3cm]davin.east) -- ([yshift=0.3cm]end.west);


%\draw[<-, ultra thick] ([yshift=-0.3cm]Opt.east) -- ([yshift=-0.3cm]Geo.west);
%\draw[<-, ultra thick] ([yshift=-0.3cm]Geo.east) -- ([yshift=-0.3cm]ros.west);
%\draw[<-, ultra thick] ([yshift=-0.3cm]ros.east) -- ([yshift=-0.3cm]davin.west);
%\draw[<-, ultra thick] ([yshift=-0.3cm]davin.east) -- ([yshift=-0.3cm]end.west);

%\node at (1.5,1) {Position};
% \node at (4.5,1) {Position};
% \node at (7.5,1) {yes};
% \node at (10.5,1) {yes};

%\node at (1.5,-1) {Force};
% \node at (4.5,1) {Position};
% \node at (7.5,1) {yes};
% \node at (10.5,1) {yes};
%\end{tikzpicture}
%\caption{Overall system with feedback in both direction}
%\end{figure}

\begin{sidewaysfigure}[h!]
	%\begin{subfigure}[b]{\textheight}
		\centering
		\resizebox{\textheight}{!}{
				\tikzset{dataset/.style = {rectangle, draw, text width = 5.5cm, minimum height=3cm}}
				\begin{tikzpicture}
				
				\node [dataset] (mpro) at (0,3) {\textbf{Microprocessor}
					\begin{itemize}[itemsep=0pt,partopsep=0pt,topsep=0pt]
					\item Data logging
					\item Ethernet communication
					\item Shutdown in case of communication error\\
					\end{itemize}};
				
				\node [dataset, below of=mpro, node distance=6.5cm] (FPGA) {\textbf{FPGA}
					\begin{itemize}[itemsep=0pt,partopsep=0pt,topsep=0pt] 
					\item Position contron
					\item Encoder counter
					\item PWM control
					\item Read data: Escon 
					\end{itemize}};
				
				\draw[->, ultra thick] ([xshift=-1cm]mpro.south) -- ([xshift=-1cm]FPGA.north);
				\draw[<-, ultra thick] ([xshift=1cm]mpro.south) -- ([xshift=1cm]FPGA.north);
				
				\node [dataset, left of=FPGA, node distance=7.5cm] (emc) {\textbf{ESCON motor controller}
					\begin{itemize}[itemsep=0pt,partopsep=0pt,topsep=0pt] 
					\item Speed controll with intter current control
					\item Limit output current
					\item Read encoder ticks 
					\end{itemize}};
				
				\draw[->, ultra thick] ([yshift=-0.5cm]emc.east) -- ([yshift=-0.5cm]FPGA.west)
				node[right of=emc, node distance=3.55cm](data1) {}
				node[above of=data1, node distance=1.7cm] {\footnotesize Speed}
				node[above of=data1, node distance=1.4cm] {\footnotesize Control}
				node[above of=data1, node distance=0.8cm] {\footnotesize Enable}
				node[below of=data1, node distance=0.8cm] {\footnotesize Position}
				node[below of=data1, node distance=1.4cm] {\footnotesize Current};
				\draw[<-, ultra thick] ([yshift=0.5cm]emc.east) -- ([yshift=0.5cm]FPGA.west);
				
				\tikzset{dataset/.style = {rectangle, draw, text width = 6cm, minimum height=10.5cm}}
				
				\node [dataset, above of=FPGA, node distance=3.5cm] (sbrio) {\textbf{sbRIO}
					\begin{itemize}[itemsep=0pt,partopsep=0pt,topsep=260pt] % Edit the last number to fit title 
					\item[]  %  This line is necessary!!
					\end{itemize}};
				
				
				\tikzset{dataset/.style = {rectangle, draw, text width = 5.5cm, minimum height=1cm}}
				
				\node [dataset, below of=emc, node distance=2.5cm] (motor) {\textbf{Motor}};
				
				\draw[->, ultra thick] ([xshift=-1cm]motor.north) -- ([xshift=-1cm]emc.south);
				\draw[<-, ultra thick] ([xshift=1cm]motor.north) -- ([xshift=1cm]emc.south);
				
				\tikzset{dataset/.style = {rectangle, draw, text width = 4.5cm, minimum height=5cm}} % This edits the size of the Ros computer box 
				
				
				\node [dataset, right of=mpro, node distance=7cm] (ROS) {\textbf{Computer}
					\begin{itemize}[itemsep=0pt,partopsep=0pt,topsep=0pt] 
					\item High level computations
					\item ROS
					\end{itemize}};
				
				\draw[->, ultra thick] ([yshift=-1cm]mpro.east) -- ([yshift=-1cm]ROS.west)node[right of=mpro, node distance=3.9cm](udp1) {UDP}
				node[above of=udp1, node distance=1.5cm] {\footnotesize Setpoint}
				node[above of=udp1, node distance=2cm] {\footnotesize Enable}
				node[below of=udp1, node distance=1.5cm] {\footnotesize Position}
				node[below of=udp1, node distance=2cm] {\footnotesize Speed}
				node[below of=udp1, node distance=2.5cm] {\footnotesize Current}; % ([yshift=-1cm]ROS.west) should probaly be edited!!!
				\draw[<-, ultra thick] ([yshift=1cm]mpro.east) -- ([yshift=1cm]ROS.west);
				
				
				
				\node [dataset, right of=ROS, node distance=6cm] (GT) {\textbf{Geomagic Touch}
					\begin{itemize}[itemsep=0pt,partopsep=0pt,topsep=0pt] 
					\item Force feedback
					\item Interfacing with\\ human
					\end{itemize}};
				
				\draw[->, ultra thick] ([yshift=-1cm]ROS.east) -- ([yshift=-1cm]GT.west)node[right of=ROS, node distance=3cm] (udp2){UDP}
				node[above of=udp2, node distance=1.5cm] {\footnotesize Setpoint}
				node[below of=udp2, node distance=1.5cm] {\footnotesize Force}
				; % ([yshift=-1cm]ROS.west) should probaly be edited!!!
				
				\draw[<-, ultra thick] ([yshift=1cm]ROS.east) -- ([yshift=1cm]GT.west);
				
				% \draw [->,ultra thick] (-1,1.5) -- (-1,-2); %Micro to FPGA
				% \draw [<-,ultra thick] (1,1.5) -- (1,-2);
				
				% \draw [->,ultra thick] (-3,-3) -- (-4,-3);
				% \draw [<-,ultra thick] (-3,-4) -- (-4,-4);
				
				\end{tikzpicture}
				
				
		}
		\caption{Interfacing between components}
		\label{interface}
	%\end{subfigure}
\end{sidewaysfigure}


%\begin{sidewaysfigure}
%\centering
%\tikzset{dataset/.style = {rectangle, draw, text width = 5.5cm, minimum height=3cm}}
%\begin{tikzpicture}
%
%\node [dataset] (mpro) at (0,3) {\textbf{Microprocessor}
%\begin{itemize}[itemsep=0pt,partopsep=0pt,topsep=0pt]
%\item Data logging
%\item Ethernet communication
%\item Shutdown in case of communication error\\
%\end{itemize}};
%
%\node [dataset, below of=mpro, node distance=6.5cm] (FPGA) {\textbf{FPGA}
%\begin{itemize}[itemsep=0pt,partopsep=0pt,topsep=0pt] 
%\item Position contron
%\item Encoder counter
%\item PWM control
%\item Read data: Escon 
%\end{itemize}};
%
%\draw[->, ultra thick] ([xshift=-1cm]mpro.south) -- ([xshift=-1cm]FPGA.north);
%\draw[<-, ultra thick] ([xshift=1cm]mpro.south) -- ([xshift=1cm]FPGA.north);
%
%\node [dataset, left of=FPGA, node distance=7.5cm] (emc) {\textbf{ESCON motor controller}
%\begin{itemize}[itemsep=0pt,partopsep=0pt,topsep=0pt] 
%\item Speed controll with intter current control
%\item Limit output current
%\item Read encoder ticks 
%\end{itemize}};
%
%\draw[->, ultra thick] ([yshift=-0.5cm]emc.east) -- ([yshift=-0.5cm]FPGA.west)
%node[right of=emc, node distance=3.55cm](data1) {}
%node[above of=data1, node distance=1.7cm] {\footnotesize Speed}
%node[above of=data1, node distance=1.4cm] {\footnotesize Control}
%node[above of=data1, node distance=0.8cm] {\footnotesize Enable}
%node[below of=data1, node distance=0.8cm] {\footnotesize Position}
%node[below of=data1, node distance=1.4cm] {\footnotesize Current};
%\draw[<-, ultra thick] ([yshift=0.5cm]emc.east) -- ([yshift=0.5cm]FPGA.west);
%
%\tikzset{dataset/.style = {rectangle, draw, text width = 6cm, minimum height=10.5cm}}
%
%\node [dataset, above of=FPGA, node distance=3.5cm] (sbrio) {\textbf{sbRIO}
%\begin{itemize}[itemsep=0pt,partopsep=0pt,topsep=260pt] % Edit the last number to fit title 
%\item[]  %  This line is necessary!!
%\end{itemize}};
%
%
%\tikzset{dataset/.style = {rectangle, draw, text width = 5.5cm, minimum height=1cm}}
%
%\node [dataset, below of=emc, node distance=2.5cm] (motor) {\textbf{Motor}};
%
%\draw[->, ultra thick] ([xshift=-1cm]motor.north) -- ([xshift=-1cm]emc.south);
%\draw[<-, ultra thick] ([xshift=1cm]motor.north) -- ([xshift=1cm]emc.south);
%
%\tikzset{dataset/.style = {rectangle, draw, text width = 4.5cm, minimum height=5cm}} % This edits the size of the Ros computer box 
%
%
%\node [dataset, right of=mpro, node distance=7cm] (ROS) {\textbf{Computer}
%\begin{itemize}[itemsep=0pt,partopsep=0pt,topsep=0pt] 
%\item High level computations
%\item ROS
%\end{itemize}};
%
%\draw[->, ultra thick] ([yshift=-1cm]mpro.east) -- ([yshift=-1cm]ROS.west)node[right of=mpro, node distance=3.9cm](udp1) {UDP}
%node[above of=udp1, node distance=1.5cm] {\footnotesize Setpoint}
%node[above of=udp1, node distance=2cm] {\footnotesize Enable}
%node[below of=udp1, node distance=1.5cm] {\footnotesize Position}
%node[below of=udp1, node distance=2cm] {\footnotesize Speed}
%node[below of=udp1, node distance=2.5cm] {\footnotesize Current}; % ([yshift=-1cm]ROS.west) should probaly be edited!!!
%\draw[<-, ultra thick] ([yshift=1cm]mpro.east) -- ([yshift=1cm]ROS.west);
%
%
%
%\node [dataset, right of=ROS, node distance=6cm] (GT) {\textbf{Geomagic Touch}
%	\begin{itemize}[itemsep=0pt,partopsep=0pt,topsep=0pt] 
%	\item Force feedback
%	\item Interfacing with\\ human
%	\end{itemize}};
%
%\draw[->, ultra thick] ([yshift=-1cm]ROS.east) -- ([yshift=-1cm]GT.west)node[right of=ROS, node distance=3cm] (udp2){UDP}
%node[above of=udp2, node distance=1.5cm] {\footnotesize Setpoint}
%node[below of=udp2, node distance=1.5cm] {\footnotesize Force}
%; % ([yshift=-1cm]ROS.west) should probaly be edited!!!
%
%\draw[<-, ultra thick] ([yshift=1cm]ROS.east) -- ([yshift=1cm]GT.west);
%
%% \draw [->,ultra thick] (-1,1.5) -- (-1,-2); %Micro to FPGA
%% \draw [<-,ultra thick] (1,1.5) -- (1,-2);
%
%% \draw [->,ultra thick] (-3,-3) -- (-4,-3);
%% \draw [<-,ultra thick] (-3,-4) -- (-4,-4);
%
%\end{tikzpicture}
%\caption{Interfacing between components}
%\label{interface}
%\end{sidewaysfigure}
%
%\todo{Include arrow, label anc new caption... elaborate this picture breifly, what do the different boxes do?}
%
%% \begin{figure}[htb]
%% \tikzset{dataset/.style = {rectangle, draw, text width = 5cm, minimum height=1in}}
%% \begin{tikzpicture}[auto, font={\scriptsize}]
%%     % Place nodes
%%     \node [dataset] (tm) {Data 1 
%%                             \begin{itemize}[itemsep=0pt,partopsep=0pt,topsep=0pt]   %% this added.
%%                                 \item{\# Adults } 
%%                                 \item{\# Children} 
%%                                 \item{Income}
%%                                 \item{Ethnicity}
%%                             \end{itemize}\par};
%%     \node [dataset, right of=tm, node distance=3in] (dmv) {Data 2 
%%                             \begin{itemize}[itemsep=0pt,partopsep=0pt,topsep=0pt] 
%%                                 \item{Data 2} 
%%                             \end{itemize}\par};
%%     % draw links
%%     \path [<->] (tm) edge node[above, sloped] {Address} (dmv);
%% \end{tikzpicture}
%%     \caption{Analysis dataset assembly.}
%%     \label{fig:dataset}
%% \end{figure}