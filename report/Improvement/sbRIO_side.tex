\subsection{Embedded sbRIO Microprocessor}
\label{Embedded}

The processor on the sbRIO board is running at a 400 MHz clockrate, while our target communication frequency is 1 kHz. This means that the code running on the processor has to be optimized in order to achieve the set goals. The fundamental UDP functions of the sbRIO are the following:

\begin{itemize}
	\setlength\itemsep{0em}
	\item Read data from the FPGA, converting position values based on the gearing
	\item Encode the data into a string
	\item Send the string through a UDP port
	\item Fix communication errors
	\item Poll incoming UDP packets, send the decoded values to the FPGA
	\item Emergency shutdown	
\end{itemize}


The code includes tools for debugging and measurement, these have a substantial impact on the communication performance. They are disabled during normal operation. LabView's array handling is far from optimal, further speed increase could be achieved by compiling a more optimized C code into a DLL file and calling it in the LabView code. The extra functionalities are the following:

\begin{itemize}	
	\setlength\itemsep{0em}
	\item Timestamp sender through UDP
	\item Time logging for packet departure and arrival to csv file
	\item Front Panel PID gain adjustment, motor enabler
	\item Manual, sinusoidal, squarewave signal generator for the motor
	\item Motor data logging to csv file
	
\end{itemize}

We need to decide how to handle connection loss. Either we turn of the motors or we stay in position.

